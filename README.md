# Compendium Keeper

Compendium Keeper is a tool that indexes Compendium data (generated by [Compendium Scribe](https://github.com/btfranklin/compendiumscribe)) into a vector database (like Pinecone) to power Retrieval-Augmented Generation (RAG) workflows.

## Features

- Easily index concepts from a Compendium into a vector store.
- Embed concept content, questions, and keywords using OpenAI embeddings.
- Store embeddings and metadata in a vector database for quick retrieval.
- Supports multiple vector databases through an extensible architecture.

## Requirements

- Python 3.12+
- [Compendium Scribe](https://github.com/btfranklin/compendiumscribe) must be installed.
- OpenAI API key.
- Pinecone API key and environment (if using Pinecone).

## Installation

1. **Clone the Repository**

```bash
git clone https://github.com/yourusername/compendiumkeeper.git
cd compendiumkeeper
```

2. **Install Dependencies**

Ensure you have [PDM](https://pdm.fming.dev/) installed. Then run:

```bash
pdm install
```

## Configuration

Create a `.env` file in the root directory of the project to store your API keys and configuration. You can use the provided `.env.example` as a template.

### Example `.env` File

```dotenv
# .env.example

# OpenAI API Key for generating embeddings
OPENAI_API_KEY=sk-your-openai-api-key

# Pinecone API Key and Environment
PINECONE_API_KEY=your-pinecone-api-key
PINECONE_ENVIRONMENT=us-east-1-aws
```

Rename `.env.example` to `.env` and replace the placeholder values with your actual API keys.

## Usage

1. **Generate a Compendium using Compendium Scribe**

```bash
compendium-scribe-create-compendium --domain "Cell Biology"
```

This produces a file like `cell_biology_2024-12-05.compendium.pickle`.

2. **Index it with Compendium Keeper**

The index name is automatically derived from the compendium filename. For `cell_biology_2024-12-05.compendium.pickle`, the index name will be `cell_biology_2024-12-05`.

Ensure your `.env` file is properly configured with the necessary API keys.

```bash
pdm run compendium-keeper index --compendium-file cell_biology_2024-12-05.compendium.pickle
```

3. **Verify Indexing**

After successful execution, you should see a confirmation message indicating the number of concepts indexed.

```bash
Indexed 25 concepts from domain 'Cell Biology' into index 'cell_biology_2024-12-05'.
Indexing complete!
```

## Extensibility

- **Multiple Vector Databases**: The architecture allows for adding support for other vector databases (e.g., Weaviate, ChromaDB) by implementing new classes in the `vector_db/` directory.
- **Custom Embedding Strategies**: Modify or extend `utils.py` to customize how embeddings are generated or processed.

## Developer Workflow

1. **Set Up Environment Variables**

    Create a `.env` file as described above.

2. **Generate a Compendium**

    Use Compendium Scribe to generate a compendium pickle file.

3. **Index with Compendium Keeper**

    Run the indexing command to upload embeddings to your chosen vector database. The index name is automatically derived from the compendium filename.

## Troubleshooting

- **Missing API Keys**

    Ensure that your `.env` file contains all required API keys. The CLI will notify you if any are missing.

- **Unsupported Vector DB**

    Currently, only Pinecone is supported. To add support for another vector database, implement a new class in `vector_db/` adhering to the `VectorDatabase` abstract base class.

- **API Rate Limits**

    Be mindful of OpenAI's API rate limits when indexing large compendia. Consider implementing batching or rate limiting if necessary.

## License

MIT License

## Contributing

Contributions are welcome! Feel free to open an issue or submit a pull request.

## License

Promptdown is released under the [MIT License](LICENSE).
